/**
 * Migration Script for FAQ Data
 * Run this to import existing FAQ data from the website to MongoDB
 * 
 * Run with: node scripts/migrate-faq.js
 */

require('dotenv').config();
const mongoose = require('mongoose');
const FAQCategory = require('../models/FAQCategory');

const faqCategories = [
    {
        name: "أسئلة عامة حول خدمات العزل",
        slug: "general-insulation-questions",
        icon: "HelpCircle",
        questions: [
            {
                question: "ما هي أنواع العزل المتوفرة لديكم؟",
                answer: "نقدم مجموعة شاملة من خدمات العزل المتخصصة تشمل: العزل المائي لحماية الأسطح من تسرب المياه والرطوبة، العزل الحراري بالفوم البولي يوريثان لتقليل استهلاك الطاقة، كشف تسربات المياه بأحدث الأجهزة الإلكترونية، وعزل الخزانات الأرضية والعلوية. جميع خدماتنا معتمدة من الجهات الحكومية ومطابقة لمعايير الجودة السعودية.",
                order: 0,
                isActive: true
            },
            {
                question: "لماذا يعتبر العزل ضرورياً للمباني في السعودية؟",
                answer: "المناخ السعودي يتميز بدرجات حرارة مرتفعة جداً في الصيف تصل إلى 50 درجة مئوية، وأمطار غزيرة موسمية قد تسبب تسربات خطيرة. العزل الجيد يحمي المبنى من تسرب المياه الذي قد يؤدي لتلف الخرسانة وصدأ الحديد، يقلل استهلاك الكهرباء للتكييف بنسبة تصل إلى 40%، يمنع نمو العفن والفطريات الضارة بالصحة، ويطيل عمر المبنى الافتراضي.",
                order: 1,
                isActive: true
            },
            {
                question: "كم تستغرق عملية العزل عادة؟",
                answer: "المدة تختلف حسب نوع الخدمة ومساحة المبنى. عزل الفوم للفلل الصغيرة والمتوسطة يستغرق من يوم إلى يومين، العزل المائي للأسطح يحتاج من 2-4 أيام حسب المساحة وطبقات العزل، عزل الخزانات يتم خلال يوم واحد للخزان الواحد، وكشف التسربات عادة يتم خلال ساعات.",
                order: 2,
                isActive: true
            },
            {
                question: "هل تقدمون ضمان على الأعمال؟",
                answer: "نعم، نقدم ضماناً شاملاً على جميع أعمالنا يتراوح من 5 إلى 15 سنة حسب نوع الخدمة والمواد المستخدمة. العزل المائي بالبيتومين يأتي بضمان 15 سنه، عزل الفوم البولي يوريثان بضمان 15 سنة، وعزل الخزانات بضمان 15 سنه.",
                order: 3,
                isActive: true
            },
            {
                question: "ما هي تكلفة خدمات العزل؟",
                answer: "الأسعار تختلف حسب نوع العزل، المساحة، حالة السطح، ونوعية المواد المستخدمة. عزل الفوم يتراوح من 25-45 ريال للمتر المربع، العزل المائي من 20-40 ريال للمتر، وكشف التسربات من 500-1500 ريال حسب حجم المشروع.",
                order: 4,
                isActive: true
            }
        ],
        order: 0,
        isActive: true
    },
    {
        name: "أسئلة حول العزل المائي",
        slug: "waterproofing-questions",
        icon: "HelpCircle",
        questions: [
            {
                question: "ما الفرق بين العزل المائي الإيجابي والسلبي؟",
                answer: "العزل المائي الإيجابي يتم تطبيقه على السطح المعرض مباشرة للماء، وهو الأكثر فعالية لأنه يمنع الماء من التسلل أصلاً. العزل السلبي يطبق من الجهة المعاكسة لمصدر المياه كحل ثانوي عندما يتعذر الوصول للسطح الخارجي.",
                order: 0,
                isActive: true
            },
            {
                question: "متى يجب تجديد العزل المائي؟",
                answer: "ينصح بفحص العزل المائي كل 3-5 سنوات للتأكد من سلامته. علامات الحاجة للتجديد تشمل: ظهور بقع رطوبة أو تسربات في الأسقف الداخلية، تشققات واضحة في طبقة العزل، تقشر أو انفصال مادة العزل عن السطح.",
                order: 1,
                isActive: true
            },
            {
                question: "هل يمكن عزل السطح أثناء فصل الصيف؟",
                answer: "نعم، لكن نفضل العمل في الصباح الباكر أو المساء لتجنب الحرارة الشديدة. الربيع والخريف أفضل المواسم للعزل حيث تكون درجات الحرارة معتدلة والأمطار نادرة.",
                order: 2,
                isActive: true
            }
        ],
        order: 1,
        isActive: true
    },
    {
        name: "أسئلة حول عزل الفوم",
        slug: "foam-insulation-questions",
        icon: "HelpCircle",
        questions: [
            {
                question: "ما هو الفوم البولي يوريثان وكيف يعمل؟",
                answer: "الفوم البولي يوريثان هو مادة عزل حديثة تتكون من خلط مادتين كيميائيتين تتفاعلان وتتمدد لتكون رغوة صلبة. تتميز بكثافة منخفضة ومسامات مغلقة تحبس الهواء داخلها، مما يجعلها عازلة ممتازة للحرارة والصوت والماء.",
                order: 0,
                isActive: true
            },
            {
                question: "كم سماكة طبقة الفوم المطلوبة؟",
                answer: "للعزل الحراري في السعودية، نوصي بسماكة 5-8 سم للأسطح المكشوفة لتحقيق عزل ممتاز وخفض الحرارة بمعدل 15-20 درجة. للعزل المائي فقط، تكفي سماكة 3-4 سم.",
                order: 1,
                isActive: true
            },
            {
                question: "هل يحتاج الفوم لطبقة حماية فوقه؟",
                answer: "نعم، الفوم البولي يوريثان يحتاج لطبقة حماية من الأشعة فوق البنفسجية التي تسبب تحلله مع الوقت. نستخدم طبقة أكريليك عاكسة للأشعة، أو طبقة بولي يوريا المرنة والمقاومة للتشقق.",
                order: 2,
                isActive: true
            }
        ],
        order: 2,
        isActive: true
    },
    {
        name: "أسئلة حول كشف التسربات",
        slug: "leak-detection-questions",
        icon: "HelpCircle",
        questions: [
            {
                question: "كيف تكتشفون التسربات بدون تكسير؟",
                answer: "نستخدم أحدث التقنيات العالمية لكشف التسربات دون الحاجة للتكسير: أجهزة الاستشعار الصوتي، كاميرات التصوير الحراري، أجهزة قياس الرطوبة الإلكترونية، وغاز النيتروجين لفحص الأنابيب المضغوطة. هذه التقنيات دقيقة بنسبة 95-98%.",
                order: 0,
                isActive: true
            },
            {
                question: "ما هي علامات وجود تسرب في المنزل؟",
                answer: "علامات تحذيرية: زيادة غير مبررة في فاتورة الماء، صوت جريان ماء خفيف عند إغلاق جميع الحنفيات، بقع رطوبة أو تغير لون الجدران والأسقف، رائحة عفن أو رطوبة في بعض الغرف.",
                order: 1,
                isActive: true
            },
            {
                question: "كم تستغرق عملية كشف التسرب؟",
                answer: "عملية الكشف عادة تستغرق من 2-4 ساعات للمنزل العادي، حسب حجم المبنى وموقع التسرب. الفحص الأولي السريع يستغرق 30-60 دقيقة، يليه الفحص التفصيلي باستخدام الأجهزة.",
                order: 2,
                isActive: true
            }
        ],
        order: 3,
        isActive: true
    },
    {
        name: "أسئلة حول عزل الخزانات",
        slug: "tank-insulation-questions",
        icon: "HelpCircle",
        questions: [
            {
                question: "ما الفرق بين عزل الخزان من الداخل والخارج؟",
                answer: "عزل الخزان من الداخل يحمي المياه من التلوث ويمنع التسرب للخارج، ويستخدم مواد غذائية خاصة آمنة للشرب. العزل الخارجي يحمي الخزان من العوامل الجوية والحرارة ويمنع تسرب المياه الخارجية للداخل.",
                order: 0,
                isActive: true
            },
            {
                question: "هل عزل الخزان يؤثر على طعم الماء؟",
                answer: "العزل الصحيح بمواد معتمدة للاستخدام الغذائي لا يؤثر إطلاقاً على طعم أو رائحة أو لون الماء. نستخدم فقط مواد حاصلة على شهادة FDA الأمريكية وموافقة هيئة الغذاء والدواء السعودية.",
                order: 1,
                isActive: true
            },
            {
                question: "كم مرة يجب عزل الخزان؟",
                answer: "الخزان الجديد يجب عزله قبل الاستخدام مباشرة. العزل بالإيبوكسي عالي الجودة يدوم 8-12 سنة، الفوم الخارجي المحمي يدوم 10-15 سنة. ننصح بالفحص الدوري السنوي للكشف المبكر عن أي تدهور.",
                order: 2,
                isActive: true
            }
        ],
        order: 4,
        isActive: true
    },
    {
        name: "أسئلة حول الأسعار والمواعيد",
        slug: "pricing-scheduling-questions",
        icon: "HelpCircle",
        questions: [
            {
                question: "كيف يتم احتساب تكلفة العزل؟",
                answer: "التكلفة تعتمد على: نوع الخدمة المطلوبة، مساحة السطح بالمتر المربع، نوع وجودة المواد المستخدمة، حالة السطح الحالية ومدى حاجته للتحضير والإصلاح، وصعوبة الوصول. نقدم معاينة مجانية وعرض سعر تفصيلي.",
                order: 0,
                isActive: true
            },
            {
                question: "هل تقدمون خصومات أو عروض خاصة؟",
                answer: "نعم، نقدم خصومات على المشاريع الكبيرة (أكثر من 200 متر مربع)، عروض موسمية، تخفيضات للعقود السنوية، وأسعار تفضيلية للعملاء المتكررين. اتصل بنا للاستفسار عن العروض الحالية.",
                order: 1,
                isActive: true
            },
            {
                question: "ما هي مناطق تغطية خدماتكم؟",
                answer: "نغطي جميع أحياء مدينة الرياض والمناطق المحيطة مثل الخرج والدرعية والمزاحمية. للمشاريع الكبيرة، نغطي معظم مناطق المملكة مع التنسيق المسبق.",
                order: 2,
                isActive: true
            }
        ],
        order: 5,
        isActive: true
    }
];

async function migrate() {
    try {
        await mongoose.connect(process.env.MONGODB_URI);
        console.log('Connected to MongoDB');

        console.log('Migrating FAQ data...');

        for (const category of faqCategories) {
            const exists = await FAQCategory.findOne({ slug: category.slug });
            if (!exists) {
                await FAQCategory.create(category);
                console.log(`Created FAQ category: ${category.name} with ${category.questions.length} questions`);
            } else {
                console.log(`FAQ category already exists: ${category.name}`);
            }
        }

        const totalCategories = await FAQCategory.countDocuments();
        console.log(`\n✅ Migration completed! Total FAQ categories: ${totalCategories}`);

    } catch (error) {
        console.error('Migration failed:', error);
    } finally {
        await mongoose.disconnect();
    }
}

migrate();
